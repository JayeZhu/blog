---
title: 作用域链
date: 2021-03-30 14:44:46
permalink: /fe/4c480e/
categories:
  - 前端
tags:
  - JavaScript
  - 调用堆栈
---
## 定义
在查找变量和函数的时候，会先从当前执行上下文的变量对象中查找，如果没有找到，就会从父级执行上下文的变量对象中查找，一直找到全局上下文的变量对象(全局对象)。这样由多个执行上下文的变量对象构成的链表就是作用域链。

作用域链在代码执行时被创建，主要用途是能够有序访问到执行环境有权访问的所有变量和函数。

## 结构
作用域链实质上是一个指向变量对象的指针列表，只存放引用而不包括变量对象，其前端始终都是当前指向上下文的变量对象，如果该变量对象被激活，则指向的是活动对象，其尾端始终指向全局执行上下文，也就是全局对象。

## 创建过程
作用域链的创建过程是动态的，会分为全局阶段、函数阶段、函数阶段还有被激活为活动对象阶段。执行上下文中的 `[[Scope]]`（作用域）
会指向这个创建的作用域链。

例子：
```javascript

```

### 全局阶段
代码执行前会创建全局执行上下文，全局上下文的 `[[Scope]]` 指向作用域链，而这个作用域链的第一个指针就指向了全局对象，可以表示为：
```javascript
globalContext.[[Scope]] = [
  globalContext.VO
];
// 这里使用了数组指代作用域链指针链表
```
在创建完作用域链后，JS 引擎还会为全局对象中的函数添加 `[[Scope]]`，这个属性就是全局上下文的`[[Scope]]`

### 函数阶段
全局上下文创建后，