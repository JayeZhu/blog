---
title: React组件
date: 2025-10-16 18:12:29
permalink: /pages/09ad60/
categories:
  - 前端
tags:
  - React
  - React核心
---
## 函数组件

### 基本语法

```javascript
// 简单函数组件
function Welcome(props) {
  return <h1>Hello, {props.name}</h1>;
}

// 箭头函数组件
const Welcome = (props) => {
  return <h1>Hello, {props.name}</h1>;
};
```

### 特点

1. **简洁性**
   - 语法简单
   - 无需this关键字
   - 代码量更少

2. **性能**
   - 没有实例
   - 更轻量
   - 更好的性能

### 实际示例

```javascript
// UserCard组件
const UserCard = ({ name, avatar, email }) => {
  return (
    <div className="user-card">
      <img src={avatar} alt={name} />
      <h3>{name}</h3>
      <p>{email}</p>
    </div>
  );
};

// 使用示例
<UserCard 
  name="John Doe"
  avatar="https://example.com/avatar.jpg"
  email="john@example.com"
/>
```

## 类组件

### 基本语法

```javascript
class Welcome extends React.Component {
  render() {
    return <h1>Hello, {this.props.name}</h1>;
  }
}
```

### 状态管理

```javascript
class Counter extends React.Component {
  constructor(props) {
    super(props);
    this.state = { count: 0 };
  }

  handleClick = () => {
    this.setState({ count: this.state.count + 1 });
  };

  render() {
    return (
      <button onClick={this.handleClick}>
        Count: {this.state.count}
      </button>
    );
  }
}
```

### 生命周期

```javascript
class UserProfile extends React.Component {
  constructor(props) {
    super(props);
    this.state = { user: null };
  }

  // 组件挂载后
  componentDidMount() {
    this.fetchUser();
  }

  // 组件更新后
  componentDidUpdate(prevProps) {
    if (prevProps.userId !== this.props.userId) {
      this.fetchUser();
    }
  }

  // 组件卸载前
  componentWillUnmount() {
    // 清理工作
  }

  fetchUser = async () => {
    const user = await fetchUser(this.props.userId);
    this.setState({ user });
  };

  render() {
    return (
      <div>
        {this.state.user ? (
          <div>{this.state.user.name}</div>
        ) : (
          <div>Loading...</div>
        )}
      </div>
    );
  }
}
```

## 组件通信

### 1. 父子组件通信

```javascript
// 父组件
function Parent() {
  const [message, setMessage] = useState('');

  const handleMessage = (msg) => {
    setMessage(msg);
  };

  return (
    <div>
      <Child onMessage={handleMessage} />
      <p>收到消息: {message}</p>
    </div>
  );
}

// 子组件
function Child({ onMessage }) {
  const handleClick = () => {
    onMessage('Hello from child');
  };

  return <button onClick={handleClick}>发送消息</button>;
}
```

### 2. 兄弟组件通信

```javascript
// 共享父组件的状态
function Parent() {
  const [sharedData, setSharedData] = useState('');

  return (
    <div>
      <SiblingA setData={setSharedData} />
      <SiblingB data={sharedData} />
    </div>
  );
}

function SiblingA({ setData }) {
  return (
    <button onClick={() => setData('Hello from A')}>
      发送到B
    </button>
  );
}

function SiblingB({ data }) {
  return <div>收到消息: {data}</div>;
}
```

### 3. Context通信

```javascript
// 创建Context
const UserContext = React.createContext();

// 父组件
function App() {
  const user = { name: 'John', age: 30 };

  return (
    <UserContext.Provider value={user}>
      <Profile />
    </UserContext.Provider>
  );
}

// 子组件
function Profile() {
  const user = useContext(UserContext);
  return <div>姓名: {user.name}, 年龄: {user.age}</div>;
}
```

### 4. 自定义Hook通信

```javascript
// 自定义Hook
function useSharedState() {
  const [state, setState] = useState(null);
  return [state, setState];
}

// 父组件
function Parent() {
  const [sharedData, setSharedData] = useSharedState();

  return (
    <SharedDataContext.Provider value={[sharedData, setSharedData]}>
      <ChildA />
      <ChildB />
    </SharedDataContext.Provider>
  );
}

// 子组件
function ChildA() {
  const [, setSharedData] = useContext(SharedDataContext);

  return (
    <button onClick={() => setSharedData('Data from A')}>
      发送数据
    </button>
  );
}
```

## 最佳实践

### 1. 组件设计原则

```javascript
// 好的实践：单一职责
const Avatar = ({ src, alt }) => (
  <img src={src} alt={alt} className="avatar" />
);

// 避免：功能过多
const UserCard = ({ user, onUpdate, onDelete }) => (
  <div>
    <img src={user.avatar} alt={user.name} />
    <h3>{user.name}</h3>
    <button onClick={() => onUpdate(user)}>更新</button>
    <button onClick={() => onDelete(user.id)}>删除</button>
  </div>
);
```

### 2. Props验证

```javascript
import PropTypes from 'prop-types';

function Button({ type, onClick, children }) {
  return (
    <button type={type} onClick={onClick}>
      {children}
    </button>
  );
}

Button.propTypes = {
  type: PropTypes.oneOf(['button', 'submit']),
  onClick: PropTypes.func.isRequired,
  children: PropTypes.node.isRequired
};
```

### 3. 默认值设置

```javascript
function Button({ 
  type = 'button', 
  onClick = () => {}, 
  children 
}) {
  return (
    <button type={type} onClick={onClick}>
      {children}
    </button>
  );
}
```

## 总结

1. **选择合适的组件类型**
   - 简单展示使用函数组件
   - 需要复杂状态管理使用类组件
   - 推荐使用函数组件和Hooks

2. **组件通信方式选择**
   - 父子通信：Props和回调
   - 兄弟通信：提升状态或Context
   - 跨层级通信：Context或自定义Hook

3. **最佳实践**
   - 保持组件单一职责
   - 做好Props验证
   - 合理设置默认值

掌握这些基础知识将帮助你构建可维护、可复用的React组件。