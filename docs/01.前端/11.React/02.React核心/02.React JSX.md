---
title: React JSX
date: 2025-10-16 18:19:58
permalink: /pages/9652d6/
categories:
  - 前端
tags:
  - React
  - React核心
---
## JSX规则

### 1. 基本语法规则

```javascript
// JSX必须有一个根元素
const element = (
  <div>
    <h1>Hello</h1>
    <p>World</p>
  </div>
);

// 使用React.Fragment避免额外div
const element = (
  <React.Fragment>
    <h1>Hello</h1>
    <p>World</p>
  </React.Fragment>
);

// 简写形式
const element = (
  <>
    <h1>Hello</h1>
    <p>World</p>
  </>
);
```

### 2. 属性命名规则

```javascript
// class改为className
const element = <div className="container">Content</div>;

// for改为htmlFor
const element = <label htmlFor="email">Email</label>;

// 布尔属性
const element = <input type="text" disabled />;

// 自定义属性使用data-前缀
const element = <div data-id="123">Content</div>;
```

### 3. JavaScript表达式

```javascript
// 在JSX中使用表达式
const name = 'John';
const element = <h1>Hello, {name}</h1>;

// 调用函数
function formatName(user) {
  return user.firstName + ' ' + user.lastName;
}

const element = <h1>Hello, {formatName(user)}</h1>;

// 对象解构
const { firstName, lastName } = user;
const element = <h1>{firstName} {lastName}</h1>;
```

## 条件渲染

### 1. 三元运算符

```javascript
// 基本三元运算符
const element = (
  <div>
    {isLoggedIn ? <UserProfile /> : <LoginButton />}
  </div>
);

// 嵌套条件
const element = (
  <div>
    {isLoading ? (
      <Spinner />
    ) : isError ? (
      <ErrorMessage />
    ) : (
      <DataList />
    )}
  </div>
);
```

### 2. 逻辑与运算符

```javascript
// 条件渲染组件
function Mailbox(props) {
  const unreadMessages = props.unreadMessages;
  return (
    <div>
      <h1>Hello!</h1>
      {unreadMessages.length > 0 && (
        <h2>
          You have {unreadMessages.length} unread messages.
        </h2>
      )}
    </div>
  );
}

// 多个条件
function Greeting(props) {
  return (
    <div>
      {props.isLoggedIn && <UserProfile />}
      {props.isAdmin && <AdminPanel />}
      {props.hasNotifications && <NotificationBadge />}
    </div>
  );
}
```

### 3. if-else语句

```javascript
// 在render外使用if
function WarningBanner(props) {
  if (!props.warn) {
    return null;
  }

  return (
    <div className="warning">
      Warning!
    </div>
  );
}

// 复杂条件判断
function getStatusMessage(status) {
  if (status === 'loading') {
    return <LoadingSpinner />;
  } else if (status === 'error') {
    return <ErrorMessage />;
  } else if (status === 'success') {
    return <SuccessMessage />;
  }
  return null;
}
```

## 列表渲染

### 1. 基本列表渲染

```javascript
// 数组映射
const numbers = [1, 2, 3, 4, 5];
const listItems = numbers.map((number) => (
  <li key={number.toString()}>
    {number}
  </li>
));

// 渲染列表
const element = <ul>{listItems}</ul>;

// 直接在JSX中映射
const element = (
  <ul>
    {numbers.map((number) => (
      <li key={number.toString()}>
        {number}
      </li>
    ))}
  </ul>
);
```

### 2. Key的重要性

```javascript
// 正确：使用唯一ID
function TodoList({ todos }) {
  return (
    <ul>
      {todos.map((todo) => (
        <li key={todo.id}>
          {todo.text}
        </li>
      ))}
    </ul>
  );
}

// 错误：使用索引作为key
function TodoList({ todos }) {
  return (
    <ul>
      {todos.map((todo, index) => (
        <li key={index}>  {/* 不推荐 */}
          {todo.text}
        </li>
      ))}
    </ul>
  );
}
```

### 3. 复杂列表渲染

```javascript
// 渲染对象数组
function UserList({ users }) {
  return (
    <div className="user-list">
      {users.map((user) => (
        <div key={user.id} className="user-card">
          <img src={user.avatar} alt={user.name} />
          <h3>{user.name}</h3>
          <p>{user.email}</p>
        </div>
      ))}
    </div>
  );
}

// 条件列表渲染
function ProductList({ products, inStockOnly }) {
  const filteredProducts = products.filter(product =>
    inStockOnly ? product.inStock : true
  );

  return (
    <ul>
      {filteredProducts.map((product) => (
        <li key={product.id}>
          {product.name}
          {!product.inStock && ' (缺货)'}
        </li>
      ))}
    </ul>
  );
}
```

## 最佳实践

### 1. 组件化列表项

```javascript
// 列表项组件
function TodoItem({ todo }) {
  return (
    <li className={todo.completed ? 'completed' : ''}>
      {todo.text}
    </li>
  );
}

// 列表组件
function TodoList({ todos }) {
  return (
    <ul>
      {todos.map((todo) => (
        <TodoItem key={todo.id} todo={todo} />
      ))}
    </ul>
  );
}
```

### 2. 条件渲染优化

```javascript
// 提取条件渲染逻辑
function LoadingState({ isLoading, error, children }) {
  if (isLoading) return <Spinner />;
  if (error) return <ErrorMessage error={error} />;
  return children;
}

// 使用
function DataComponent({ data, isLoading, error }) {
  return (
    <LoadingState isLoading={isLoading} error={error}>
      <DataDisplay data={data} />
    </LoadingState>
  );
}
```

### 3. 性能优化

```javascript
// 使用useMemo优化列表渲染
function UserList({ users }) {
  const memoizedUsers = useMemo(() => 
    users.map(user => ({
      ...user,
      fullName: `${user.firstName} ${user.lastName}`
    })),
    [users]
  );

  return (
    <div>
      {memoizedUsers.map(user => (
        <UserCard key={user.id} user={user} />
      ))}
    </div>
  );
}
```

## 总结

1. **JSX规则**
   - 必须有根元素
   - 属性命名规范
   - JavaScript表达式使用

2. **条件渲染**
   - 选择合适的条件渲染方式
   - 保持代码简洁
   - 提取复杂逻辑

3. **列表渲染**
   - 正确使用key
   - 组件化列表项
   - 性能优化考虑

掌握这些JSX基础语法将帮助你编写更清晰、更高效的React代码。
