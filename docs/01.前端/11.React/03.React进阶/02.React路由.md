---
title: React路由
date: 2025-10-17 15:51:13
permalink: /pages/c390e8/
categories:
  - 前端
tags:
  - React
  - React进阶
---
## React Router概述

React Router是React生态系统中最流行的路由库，它允许你在应用中实现声明式路由。通过React Router，你可以构建单页应用（SPA），实现页面间的无缝切换，同时保持URL与UI的同步。

## 安装和基础配置

### 安装

```bash
# 安装React Router
npm install react-router-dom

# 或使用yarn
yarn add react-router-dom
```

### 基础配置

```javascript
// App.js
import { BrowserRouter, Routes, Route } from 'react-router-dom';

function App() {
  return (
    <BrowserRouter>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
        <Route path="/contact" element={<Contact />} />
      </Routes>
    </BrowserRouter>
  );
}
```

## 核心组件详解

### 1. BrowserRouter

#### 使用说明
```javascript
<BrowserRouter>
  {/* 路由配置 */}
</BrowserRouter>
```

#### 参数含义
- `basename`: 设置所有路由的基础URL
- `forceRefresh`: 是否强制页面刷新
- `getUserConfirmation`: 导航确认函数

#### 适用场景
- 标准Web应用
- 需要历史记录管理
- 需要URL同步

#### 缺点
- 需要服务器配置支持
- 不适用于移动应用

#### 示例
```javascript
<BrowserRouter basename="/app">
  <Routes>
    <Route path="/" element={<Home />} />
  </Routes>
</BrowserRouter>
```

### 2. Routes和Route

#### 使用说明
```javascript
<Routes>
  <Route path="/path" element={<Component />} />
</Routes>
```

#### 参数含义
- `path`: 路由匹配模式
- `element`: 要渲染的组件
- `caseSensitive`: 是否区分大小写

#### 适用场景
- 多页面应用
- 嵌套路由
- 动态路由

#### 示例
```javascript
<Routes>
  <Route path="/" element={<Home />} />
  <Route path="/users/:id" element={<UserProfile />} />
  <Route path="/posts/*" element={<Posts />}>
    <Route path=":id" element={<PostDetail />} />
  </Route>
</Routes>
```

### 3. Link

#### 使用说明
```javascript
<Link to="/path">Text</Link>
```

#### 参数含义
- `to`: 目标路径
- `replace`: 是否替换历史记录
- `state`: 传递状态数据

#### 适用场景
- 程序化导航
- 导航菜单
- 面包屑

#### 缺点
- 不支持外部链接
- 需要配合Routes使用

#### 示例
```javascript
<Link to="/about" state={{ from: 'home' }}>
  About Us
</Link>
```

### 4. Navigate

#### 使用说明
```javascript
<Navigate to="/path" replace />
```

#### 参数含义
- `to`: 重定向路径
- `replace`: 是否替换历史记录
- `state`: 传递状态数据

#### 适用场景
- 权限控制
- 登录重定向
- 默认路由

#### 示例
```javascript
<Route path="/old-path" element={<Navigate to="/new-path" replace />} />
```

## 高级功能

### 1. 动态路由

#### 使用说明
```javascript
<Route path="/users/:id" element={<User />} />
```

#### 参数获取
```javascript
import { useParams } from 'react-router-dom';

function User() {
  const { id } = useParams();
  return <div>User ID: {id}</div>;
}
```

### 2. 嵌套路由

#### 使用说明
```javascript
<Route path="/app" element={<Layout />}>
  <Route path="dashboard" element={<Dashboard />} />
  <Route path="settings" element={<Settings />} />
</Route>
```

#### 示例
```javascript
function Layout() {
  return (
    <div>
      <nav>
        <Link to="dashboard">Dashboard</Link>
        <Link to="settings">Settings</Link>
      </nav>
      <Outlet />
    </div>
  );
}
```

### 3. 路由守卫

#### 使用说明
```javascript
function PrivateRoute({ children }) {
  const auth = useAuth();
  return auth ? children : <Navigate to="/login" />;
}
```

#### 示例
```javascript
<Route
  path="/dashboard"
  element={
    <PrivateRoute>
      <Dashboard />
    </PrivateRoute>
  }
/>
```

## 路由Hooks

### 1. useParams

#### 使用说明
```javascript
const params = useParams();
```

#### 适用场景
- 获取动态参数
- 组件参数处理

#### 示例
```javascript
function Post() {
  const { id, category } = useParams();
  return <div>Post {id} in {category}</div>;
}
```

### 2. useLocation

#### 使用说明
```javascript
const location = useLocation();
```

#### 适用场景
- 获取当前URL信息
- 监听路由变化

#### 示例
```javascript
function useQuery() {
  return new URLSearchParams(useLocation().search);
}
```

### 3. useNavigate

#### 使用说明
```javascript
const navigate = useNavigate();
```

#### 适用场景
- 程序化导航
- 条件导航

#### 示例
```javascript
function LoginButton() {
  const navigate = useNavigate();
  
  const handleLogin = () => {
    // 登录逻辑
    navigate('/dashboard');
  };

  return <button onClick={handleLogin}>Login</button>;
}
```

## 最佳实践

### 1. 路由组织

```javascript
// routes/index.js
export const routes = [
  {
    path: '/',
    element: <Layout />,
    children: [
      { path: '', element: <Home /> },
      { path: 'about', element: <About /> },
    ]
  }
];
```

### 2. 代码分割

```javascript
import { lazy, Suspense } from 'react';

const Home = lazy(() => import('./pages/Home'));

function App() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <Routes>
        <Route path="/" element={<Home />} />
      </Routes>
    </Suspense>
  );
}
```

### 3. 性能优化

```javascript
// 使用React.memo优化路由组件
const HomePage = React.memo(function HomePage() {
  return <div>Home</div>;
});

// 使用useMemo优化路由配置
const routes = useMemo(() => [
  { path: '/', element: <HomePage /> },
], []);
```

## 常见问题解决

### 1. 404页面

```javascript
<Route path="*" element={<NotFound />} />
```

### 2. 滚动恢复

```javascript
import { useEffect } from 'react';
import { useLocation } from 'react-router-dom';

function ScrollToTop() {
  const { pathname } = useLocation();

  useEffect(() => {
    window.scrollTo(0, 0);
  }, [pathname]);

  return null;
}
```

## 总结

1. **优势**
   - 声明式路由
   - 代码分割支持
   - 丰富的API
   - 良好的性能

2. **使用建议**
   - 合理组织路由结构
   - 使用代码分割优化
   - 实现适当的路由守卫
   - 注意SEO优化

3. **注意事项**
   - 服务器配置支持
   - 路由权限控制
   - 性能优化考虑
   - 用户体验提升

React Router是构建现代React应用不可或缺的工具，通过合理使用其功能，可以构建出用户体验良好的单页应用。