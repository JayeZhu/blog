---
title: Node模块自定义
date: 2025-10-13 17:40:05
permalink: /pages/560451/
categories:
  - 后端
tags:
  - NodeJS
  - Node模块
---

## Node模块定义规范
- 文件名应具有描述性，反映模块功能
- 避免与核心模块名称冲突
- 通常使用.js作为文件扩展名

## Node模块导出

### 定义模块
在模块文件中，我们可以定义变量、函数、类等任何JavaScript支持的结构：
```javascript
// mathTools.js
const version = '1.0.0';

function add(a, b) {
  return a + b;
}

function multiply(a, b) {
  return a * b;
}

function subtract(a, b) {
  return a - b;
}

function divide(a, b) {
  if(b === 0) {
    throw new Error('除数不能为零');
  }
  return a / b;
}
```
### 导出模块
#### module.exports导出​：

```javascript
module.exports = {
  add,
  multiply,
  subtract,
  divide,
  version
};
```

#### exports导出​：

```javascript
exports.add = add;
exports.multiply = multiply;
exports.subtract = subtract;
exports.divide = divide;
exports.version = version;
```
#### $module.exports与exports的区别
虽然exports是module.exports的一个引用，但它们在使用上有重要区别：
- 初始状态下，exports和module.exports指向同一个空对象
- 如果直接给exports赋值新对象（如exports = {a: 1}），它会失去与module.exports的关联
- 在引入模块时，始终以module.exports的值为准
- 为避免混淆，建议始终使用module.exports


## Node模块引入
### 引入模块
使用require()函数引入模块：
```javascript
const mathTools = require('./mathTools');
```
### 使用模块
引入模块后，我们可以使用模块中导出的变量、函数、类等：
```javascript
const result = mathTools.add(2, 3);
console.log(result); // 5
```

## Node模块发布为 npm 包
### 创建 package.json 文件
在模块目录中运行以下命令，创建 package.json 文件：
```bash
npm init -y
```
### 添加模块信息
在 package.json 文件中添加模块信息：
```json
{
  "name": "my-math-tools",
  "version": "1.0.0",
  "description": "一组实用的数学工具函数",
  "main": "mathTools.js",
  "keywords": ["math", "utilities", "tools"],
  "author": "Your Name",
  "license": "MIT"
}
```

### 发布到 npm
在发布前，应对模块进行充分测试：
```javascript
// mathTools.test.js
const mathTools = require('./mathTools');

console.assert(mathTools.add(2, 3) === 5, '加法测试失败');
console.assert(mathTools.multiply(4, 5) === 20, '乘法测试失败');
console.log('所有测试通过');
```
测试通过后，可以使用`npm publish`命令发布模块。