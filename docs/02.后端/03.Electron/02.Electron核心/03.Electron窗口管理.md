---
title: Electron窗口管理
date: 2025-10-20 12:23:45
permalink: /pages/744442/
categories:
  - 后端
tags:
  - Electron
  - Electron核心
---
Electron 提供了强大的窗口管理功能，允许开发人员创建和控制应用程序窗口。本指南将介绍 Electron 窗口管理的基本概念和常用方法。

## 创建窗口

在 Electron 中，可以使用 `BrowserWindow` 模块创建新窗口：

```javascript
const { BrowserWindow } = require('electron')

function createWindow() {
  const win = new BrowserWindow({
    width: 800,
    height: 600,
    webPreferences: {
      nodeIntegration: true,
      contextIsolation: false
    }
  })

  win.loadFile('index.html')
}
```

## 窗口属性配置

创建窗口时，可以配置多种属性：

- `width` 和 `height`：设置窗口尺寸
- `minWidth` 和 `minHeight`：设置最小尺寸
- `resizable`：控制窗口是否可调整大小
- `frame`：控制窗口是否显示边框
- `transparent`：创建透明窗口
- `alwaysOnTop`：保持窗口始终置顶
- `fullscreen`：窗口是否全屏显示

## 窗口事件处理

Electron 窗口支持多种事件，例如：

```javascript
win.on('closed', () => {
  // 当窗口关闭时触发
})

win.on('maximize', () => {
  // 当窗口最大化时触发
})

win.on('minimize', () => {
  // 当窗口最小化时触发
})
```

## 窗口控制方法

可以使用以下方法控制窗口：

- `win.maximize()`：最大化窗口
- `win.minimize()`：最小化窗口
- `win.restore()`：恢复窗口
- `win.close()`：关闭窗口
- `win.hide()`：隐藏窗口
- `win.show()`：显示窗口
- `win.center()`：将窗口居中显示

## 多窗口管理

对于需要多个窗口的应用程序，可以创建窗口管理系统：

```javascript
let windows = []

function createNewWindow() {
  const win = new BrowserWindow({
    width: 800,
    height: 600
  })
  
  win.loadFile('another-window.html')
  windows.push(win)
  
  win.on('closed', () => {
    // 从窗口数组中移除已关闭的窗口
    const index = windows.indexOf(win)
    if (index > -1) {
      windows.splice(index, 1)
    }
  })
}
```

## 窗口间通信

Electron 提供了多种窗口间通信方式：

1. 使用 `ipcMain` 和 `ipcRenderer` 模块进行主进程和渲染进程间的通信
2. 使用 `BrowserWindow.webContents.send()` 从主进程向特定窗口发送消息
3. 使用 `localStorage` 或 `sessionStorage` 在窗口间共享数据

## 窗口状态保存

可以使用 `electron-store` 或类似库保存窗口状态：

```javascript
const Store = require('electron-store')
const store = new Store()

function createWindow() {
  const win = new BrowserWindow({
    width: store.get('window.width', 800),
    height: store.get('window.height', 600),
    x: store.get('window.x'),
    y: store.get('window.y')
  })
  
  win.on('close', () => {
    const bounds = win.getBounds()
    store.set('window', bounds)
  })
}
```

## 窗口菜单集成

可以将窗口操作集成到应用程序菜单中：

```javascript
const { Menu } = require('electron')

const template = [
  {
    label: '窗口',
    submenu: [
      { role: 'minimize' },
      { role: 'close' }
    ]
  }
]

const menu = Menu.buildFromTemplate(template)
Menu.setApplicationMenu(menu)
```

## 窗口快捷键

可以为窗口操作设置快捷键：

```javascript
const { app, globalShortcut } = require('electron')

app.whenReady().then(() => {
  // 注册 Ctrl+N 创建新窗口
  globalShortcut.register('CommandOrControl+N', () => {
    createNewWindow()
  })
})
```

## 最佳实践

1. 合理管理窗口生命周期，避免内存泄漏
2. 在应用程序关闭前确保所有窗口都已正确关闭
3. 考虑使用单例模式管理主要窗口
4. 为不同类型的窗口创建不同的模板和配置
5. 实现窗口状态的持久化存储，提升用户体验

Electron 的窗口管理功能强大而灵活，通过合理使用这些功能，可以创建出符合用户期望的桌面应用程序界面。